
const testGraph = {
  "root": {
    "id": "server-ide62032a65c892",
    "name": "Server",
    "ip": "64.225.30.100",
    "type": "root-server-node",
    "children": [
      "10.74.8.34",
      "10.74.8.46",
      "10.74.8.34",
      "10.74.8.40",
      "10.74.8.38",
      "10.74.8.34",
      "10.74.8.42",
      "10.74.8.34",
      "10.74.8.48"
    ]
  },
  "node_graph": {
    "62.144.239.139": {
      "id": "server-id287f41e3d108c",
      "name": "new_user",
      "ip": "62.144.239.139",
      "type": "desktop",
      "children": []
    },
    "10.74.8.34": {
      "id": "server-idf62a55c3c5085",
      "name": "10.74.8.34",
      "ip": "10.74.8.34",
      "type": "intermediate-node",
      "children": [
        "138.197.248.250"
      ]
    },
    "138.197.248.250": {
      "id": "server-idda69bc08798e7",
      "name": "138.197.248.250",
      "ip": "138.197.248.250",
      "type": "intermediate-node",
      "children": [
        "138.197.248.14"
      ]
    },
    "138.197.248.14": {
      "id": "server-id1376fc7e6a074",
      "name": "138.197.248.14",
      "ip": "138.197.248.14",
      "type": "intermediate-node",
      "children": [
        "62.115.45.5"
      ]
    },
    "62.115.45.5": {
      "id": "server-id952a40b86ac88",
      "name": "nyk-b11-link.ip.twelve99.net",
      "ip": "62.115.45.5",
      "type": "intermediate-node",
      "children": [
        "62.115.112.68"
      ]
    },
    "62.115.112.68": {
      "id": "server-id3e356370d3397",
      "name": "nyk-bb1-link.ip.twelve99.net",
      "ip": "62.115.112.68",
      "type": "intermediate-node",
      "children": [
        "62.115.135.147"
      ]
    },
    "62.115.135.147": {
      "id": "server-idd5cc30fda68d6",
      "name": "ddf-b3-link.ip.twelve99.net",
      "ip": "62.115.135.147",
      "type": "intermediate-node",
      "children": [
        "213.248.90.55"
      ]
    },
    "213.248.90.55": {
      "id": "server-id50bd2b76881a6",
      "name": "ecotelcomm-ic-361460.ip.twelve99-cust.net",
      "ip": "213.248.90.55",
      "type": "intermediate-node",
      "children": [
        "62.27.97.9"
      ]
    },
    "62.27.97.9": {
      "id": "server-id97fcfe251b4e",
      "name": "et-0-1-4.cr02.r001.fra0.as12312.net",
      "ip": "62.27.97.9",
      "type": "intermediate-node",
      "children": [
        "62.144.239.139"
      ]
    },
    "10.74.8.46": {
      "id": "server-id542ce7c09ec66",
      "name": "10.74.8.46",
      "ip": "10.74.8.46",
      "type": "intermediate-node",
      "children": [
        "138.197.248.226"
      ]
    },
    "138.197.248.226": {
      "id": "server-id873459cf0a4c",
      "name": "138.197.248.226",
      "ip": "138.197.248.226",
      "type": "intermediate-node",
      "children": [
        "138.197.248.12"
      ]
    },
    "138.197.248.12": {
      "id": "server-id402af126644d",
      "name": "138.197.248.12",
      "ip": "138.197.248.12",
      "type": "intermediate-node",
      "children": [
        "62.115.45.9"
      ]
    },
    "62.115.45.9": {
      "id": "server-ideefcc853c4064",
      "name": "nyk-b11-link.ip.twelve99.net",
      "ip": "62.115.45.9",
      "type": "intermediate-node",
      "children": [
        "62.115.112.68"
      ]
    },
    "138.197.248.236": {
      "id": "server-id41726048cf664",
      "name": "138.197.248.236",
      "ip": "138.197.248.236",
      "type": "intermediate-node",
      "children": [
        "138.197.248.14"
      ]
    },
    "62.115.140.43": {
      "id": "server-id25e3c83bc4303",
      "name": "adm-bb4-link.ip.twelve99.net",
      "ip": "62.115.140.43",
      "type": "intermediate-node",
      "children": [
        "62.115.135.147"
      ]
    },
    "62.27.94.234": {
      "id": "server-id43d89e0fc6dba",
      "name": "62.27.94.234",
      "ip": "62.27.94.234",
      "type": "intermediate-node",
      "children": [
        "62.144.239.139"
      ]
    },
    "10.74.8.40": {
      "id": "server-idc397760f6533c",
      "name": "10.74.8.40",
      "ip": "10.74.8.40",
      "type": "intermediate-node",
      "children": [
        "138.197.248.250"
      ]
    },
    "138.197.248.56": {
      "id": "server-ide929458b3afbf",
      "name": "138.197.248.56",
      "ip": "138.197.248.56",
      "type": "intermediate-node",
      "children": [
        "62.115.45.9"
      ]
    },
    "10.74.8.38": {
      "id": "server-idf0630cb93f6f",
      "name": "10.74.8.38",
      "ip": "10.74.8.38",
      "type": "intermediate-node",
      "children": [
        "138.197.248.226"
      ]
    },
    "138.197.248.60": {
      "id": "server-idc6b9450685fb7",
      "name": "138.197.248.60",
      "ip": "138.197.248.60",
      "type": "intermediate-node",
      "children": [
        "62.115.45.5"
      ]
    },
    "138.197.248.18": {
      "id": "server-ida089872270d02",
      "name": "138.197.248.18",
      "ip": "138.197.248.18",
      "type": "intermediate-node",
      "children": [
        "62.115.45.9"
      ]
    },
    "10.74.8.42": {
      "id": "server-id0750d7ed289a1",
      "name": "10.74.8.42",
      "ip": "10.74.8.42",
      "type": "intermediate-node",
      "children": [
        "138.197.248.226"
      ]
    },
    "138.197.248.54": {
      "id": "server-id51ff5e0647e",
      "name": "138.197.248.54",
      "ip": "138.197.248.54",
      "type": "intermediate-node",
      "children": [
        "62.115.45.9"
      ]
    },
    "10.74.8.48": {
      "id": "server-id31d7964686e64",
      "name": "10.74.8.48",
      "ip": "10.74.8.48",
      "type": "intermediate-node",
      "children": [
        "138.197.248.238"
      ]
    },
    "138.197.248.238": {
      "id": "server-id5fb72781416f4",
      "name": "138.197.248.238",
      "ip": "138.197.248.238",
      "type": "intermediate-node",
      "children": [
        "138.197.248.58"
      ]
    },
    "138.197.248.58": {
      "id": "server-id2b8f1e8bdf30d",
      "name": "138.197.248.58",
      "ip": "138.197.248.58",
      "type": "intermediate-node",
      "children": [
        "62.115.45.5"
      ]
    }
  }
}

/**
socket.on("serverGraphUpdate", (s) => {
  server_graph=s;
  for(let node in server_graph.node_graph) {
    if(node in display_graph) {
      continue;
    }
    x_pos = random(windowWidth);
    y_pos = random(windowHeight);

    display_graph[node] = {
      x: x_pos,
      y: y_pos,
      children: server_graph.node_graph[node].children,
    }
  }
})
**/

// let socket = io();

let display_graph = {}
let server_graph = {}



function setup() {
  createCanvas(windowWidth, windowHeight);

  server_graph=testGraph

  for(let node in server_graph.node_graph) {
    if(node in display_graph) {
      continue;
    }
    x_pos = random(windowWidth);
    y_pos = random(windowHeight);

    display_graph[node] = {
      x: x_pos,
      y: y_pos,
      children: server_graph.node_graph[node].children,
    }
  }
}

function draw() {
  // draw nodes
  for(let node in display_graph) {
    ellipse(display_graph[node].x, display_graph[node].y, 40);
    text(node, display_graph[node].x, display_graph[node].y);
  }

  // draw edges
  for(let node in display_graph) {
    for(let child of display_graph[node].children) {
      if(display_graph[child]) {
        line(display_graph[node].x, display_graph[node].y, display_graph[child].x, display_graph[child].y);
      }
    }
  }
}
